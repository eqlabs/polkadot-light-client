cmake_minimum_required(VERSION 3.14)

project(cpp-libp2p)
include(ExternalProject)

message(STATUS "asdf 5 SORALOG_GITHUB_HOST=${SORALOG_GITHUB_HOST}")
message(STATUS "asdf 6 SQLITE_GITHUB_HOST=${SQLITE_GITHUB_HOST}")
message(STATUS "asdf 7 GITHUB_HOST=${GITHUB_HOST}")

message(STATUS "asdf 1 -DCMAKE_TOOLCHAIN_FILE=${CMAKE_TOOLCHAIN_FILE} -DPACKAGE_MANAGER=Conan -DSORALOG_GITHUB_HOST=${SORALOG_GITHUB_HOST} -DSQLITE_GITHUB_HOST=${SQLITE_GITHUB_HOST}")

set(INSTALL_DIR "${CMAKE_BINARY_DIR}/install")
ExternalProject_Add(cpp-libp2p
    GIT_REPOSITORY     "git@${GITHUB_HOST}:eqlabs/cpp-libp2p.git"
    GIT_TAG            "github-action"
    GIT_SHALLOW        TRUE
    DOWNLOAD_DIR       "${CMAKE_BINARY_DIR}/download"
    SOURCE_DIR         "${CMAKE_BINARY_DIR}/src"
    BINARY_DIR         "${CMAKE_BINARY_DIR}/build"
    INSTALL_DIR        "${INSTALL_DIR}"
    CMAKE_ARGS         -DCMAKE_INSTALL_PREFIX=${INSTALL_DIR} -DCMAKE_TOOLCHAIN_FILE=${CMAKE_TOOLCHAIN_FILE} -DPACKAGE_MANAGER=Conan -DSAN=${SAN} -DSORALOG_GITHUB_HOST=${SORALOG_GITHUB_HOST} -DSQLITE_GITHUB_HOST=${SQLITE_GITHUB_HOST})
